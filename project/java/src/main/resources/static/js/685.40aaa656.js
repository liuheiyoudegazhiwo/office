"use strict";(self["webpackChunkproject"]=self["webpackChunkproject"]||[]).push([[685],{4106:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pendingflag,expression:"pendingflag"}],staticClass:"user-main"},[t("toppage",{attrs:{lefttitle:e.lefttitle}}),t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"user-demoright",attrs:{span:24}},[t("div",{staticClass:"demo-user-search"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("div",{staticClass:"demo-input-suffix"},[e._v(" 资料名称 "),t("el-input",{staticClass:"search-user",attrs:{placeholder:"请输入内容"},model:{value:e.search.keyword,callback:function(t){e.$set(e.search,"keyword",t)},expression:"search.keyword"}})],1)]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"search-butgroup"},[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search",round:""},on:{click:e.searchfun}},[e._v("搜索 ")])],1)])],1)],1),t("div",{staticClass:"demo-user-contentfu"},[t("div",{staticClass:"demo-user-page"},[t("el-table",{ref:"multipleTable",staticClass:"demo-user-tablemore",staticStyle:{width:"100%"},attrs:{"header-cell-style":e.headerstyle,data:e.tableData,height:"500","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},e._l(e.griddata,(function(e,i){return t("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label,width:e.width}})})),1)],1)])])],1),t("el-dialog",{attrs:{title:"查看图片",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("img",{staticClass:"diagimg",attrs:{src:e.imgshow}})]),t("el-dialog",{staticClass:"diaitemrole",attrs:{title:e.roleinfotitle,visible:e.dialogroleVisible,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.dialogroleVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"资料标题",prop:"title"}},[t("el-input",{attrs:{placeholder:"请输入资料标题",maxlength:"30"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"资料介绍",prop:"detail"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入资料内容"},model:{value:e.form.detail,callback:function(t){e.$set(e.form,"detail",t)},expression:"form.detail"}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"资料链接",prop:"detail2"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入资料链接"},model:{value:e.form.detail2,callback:function(t){e.$set(e.form,"detail2",t)},expression:"form.detail2"}})],1)],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.userinfosubmit}},[e._v("确 定")]),t("el-button",{on:{click:function(t){e.dialogroleVisible=!1}}},[e._v("取 消")])],1)],1),t("el-dialog",{attrs:{title:"",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{attrs:{model:e.formvisi}},[t("el-form-item",[t("el-input",{attrs:{placeholder:e.placeholdercontent,autocomplete:"off"},model:{value:e.formvisi.content,callback:function(t){e.$set(e.formvisi,"content",t)},expression:"formvisi.content"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitsubfun}},[e._v("确 定")])],1)],1)],1)},l=[],a=(i(435),i(287)),o=i(6365),r=i(3066),n={name:"extenddevice",components:{toppage:r.A},created(){this.userinfo=JSON.parse(sessionStorage.getItem("userinfo")),this.init()},data(){return{lefttitle:"电子资源",dialogTableVisible:!1,dialogFormVisible:!1,id:"",placeholdercontent:"",formvisi:{content:""},userinfo:{},drawer:!1,textarea:"",commentList:[],pendingflag:!1,updatetype:"",single:!0,multiple:!0,roleinfotitle:"",dialogcolnmVisible:!1,dialogroleVisible:!1,dataTree:[],search:{keyword:"",status:"正常"},griddata:[{prop:"datetime",label:"发布时间",width:""},{prop:"title",label:"资料标题",width:""},{prop:"detail",label:"资料介绍",width:""},{prop:"detail2",label:"链接",width:""},{prop:"submitbody",label:"发布人",width:""}],tableData:[],multipleSelection:[],currentPage:1,form:{title:"",tapstr:"",detail:"",detail2:"",detail3:"",detail4:""},rules:{title:[{required:!0,message:"资料名称不能为空",trigger:"blur"}]},current:1,size:10,total:0,dataitem:[],imgshow:"",fileListwl:[],options:[{value:0,label:"酸味"},{value:1,label:"甜味"},{value:2,label:"苦味"},{value:3,label:"辣味"},{value:4,label:"鲜味"},{value:5,label:"麻辣"},{value:6,label:"酸辣"},{value:7,label:"香辣"}]}},methods:{init(){this.query()},showimg(e){this.dialogTableVisible=!0,this.imgshow=e},searchfun(){this.query()},resetfun(){this.search.keyword=""},handleChange(e){console.log(e)},handleRemovewl(e,t){this.fileListwl=t},handlePictureCardPreviewwl(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSuccesswl(e,t,i){console.log(e,t,i);let s=e,l=t.name,a={url:s,name:l};this.fileListwl.push(a)},handleSelectionChange(e){this.multipleSelection=e,this.single=1!=e.length,this.multiple=!e.length},handleSizeChange(e){this.size=e,this.query()},handleCurrentChange(e){this.current=e,this.query()},headerstyle(){return"background-color: #f1f1f1"},colnmsubmit(){this.dialogcolnmVisible=!1},query(){let e={current:this.current,keyword:this.search.keyword,size:this.size,status:"正常"==this.search.status?0:1};this.pendingflag=!0,(0,a.Jq)(e).then((e=>{this.tableData=e.map(((e,t)=>(e.status=0==e.status,e.tapstr=JSON.parse(e.tapstr),e.trans_pic&&(e.trans_Arrpic=e.trans_pic.split("^^^")),e))),this.pendingflag=!1})).catch((e=>{this.pendingflag=!1}))},getnowdate(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,s=e.getDate()<10?"0"+e.getDate():e.getDate(),l=t+"-"+i+"-"+s;return l},getnowtime(){let e=new Date,t=e.getHours(),i=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),s=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),l=t+":"+i+":"+s;return l},userinfosubmit(){let e=this.userinfo;if(this.pendingflag=!0,"新增资料"==this.roleinfotitle){let t={trans_pic:this.transpicurl(this.fileListwl),title:this.form.title,tapstr:JSON.stringify(this.form.tapstr),detail:this.form.detail,detail2:this.form.detail2,detail3:this.form.detail3,detail4:this.form.detail4,datetime:this.getnowdate()+" "+this.getnowtime(),submitbody:e.userName,status:1};this.reset(),(0,a.mx)(t).then((e=>{this.query(),this.$message.success("操作成功"),this.dialogitemVisible=!1})).catch((e=>{this.dialogitemVisible=!1,this.pendingflag=!1}))}else{let t;"top"==this.updatetype&&(t=this.multipleSelection[0].id),"line"==this.updatetype&&(t=this.form.id);let i={trans_pic:this.transpicurl(this.fileListwl),title:this.form.title,tapstr:JSON.stringify(this.form.tapstr),detail:this.form.detail,detail2:this.form.detail2,detail3:this.form.detail3,detail4:this.form.detail4,datetime:this.getnowdate()+" "+this.getnowtime(),submitbody:e.userName,id:t};(0,a.ul)(i).then((e=>{this.query(),this.$message.success("操作成功"),this.dialogitemVisible=!1})).catch((e=>{this.dialogitemVisible=!1,this.pendingflag=!1}))}this.dialogroleVisible=!1},updatedata(){this.dialogroleVisible=!0,this.roleinfotitle="修改资料",this.updatetype="top",this.form=this.multipleSelection[0]},seedata(e,t){this.id=t.id,this.drawer=!0},transpicurl(e){let t=[];return e.forEach((e=>{t.push(e.url)})),t.join("^^^")},handleEdit(e,t){this.updatetype="line",this.roleinfotitle="修改资料",this.dialogroleVisible=!0;let i=(0,o.A4)(t);this.form=i,this.form.status=i.status?0:1,console.log(this.form);let s=i.trans_pic;try{if(s.indexOf("^^^")>-1||s){let e=s.split("^^^"),t=[];e.forEach(((e,i)=>{let s={url:e,name:""};t.push(s)})),this.fileListwl=t}else this.fileListwl=[]}catch(l){this.fileListwl=[]}},changestatus(e,t){let i={id:t.id,status:t.status?0:1};(0,a.ge)(i).then((e=>{this.query(),this.$message.success("操作成功")})).catch((e=>{}))},handleDelete(e,t){let i=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{i.pendingflag=!0;let e={id:t.id};i.pendingflag=!0,(0,a.Vd)(e).then((e=>{i.query(),i.$message.success("操作成功")})).catch((e=>{i.$message.error("操作失败"),i.pendingflag=!1}))})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},addtop(){this.dialogroleVisible=!0,this.roleinfotitle="新增资料",this.reset()},reset(){this.form.title="",this.form.detail="",this.form.tapstr="",this.form.detail2="",this.form.detail3="",this.form.detail4="",this.fileListwl=[]},querychatfun(){let e={id:this.id};(0,a.lc)(e).then((e=>{console.log(e);let t=[];e.forEach((e=>{0==e.parentid&&t.push(e)})),t=t.map(((e,t)=>(e.CHILD_ANWSER_LIST=[],e)));for(let i=0;i<t.length;i++)for(let s=0;s<e.length;s++)t[i].id==e[s].parentid&&t[i].CHILD_ANWSER_LIST.push(e[s]);this.commentList=t})).catch((e=>{console.log(e)}))},submitfun(){if(console.log(this.userinfo),!this.userinfo)return this.$message({message:"请先登录",type:"error",duration:1e3}),!1;let e={annid:this.id,firstnickname:this.userinfo.userName,is_praise:null,comment:this.textarea,praise_num:0,candelete:0,headimgurl:"https://ossweb-img.qq.com/images/lol/web201310/skin/big10006.jpg",parentid:0,secondnickname:null,comment_time:this.getnowdate()+" "+this.getnowtime()};(0,a.qV)(e).then((e=>{console.log(e),this.$message({message:"提交成功",type:"success",duration:3e3}),this.textarea="",this.querychatfun()})).catch((e=>{console.log(e)}))},submitsubfun(){if(!this.userinfo)return this.$message({message:"请先登录",type:"error",duration:3e3}),!1;let e;e=0==this.recevobj.parentid?this.recevobj.id:this.recevobj.parentid;let t={annid:this.id,firstnickname:this.userinfo.userName,is_praise:null,comment:this.formvisi.content,praise_num:0,candelete:0,headimgurl:"https://ossweb-img.qq.com/images/lol/web201310/skin/big10006.jpg",parentid:e,secondnickname:this.recevobj.firstnickname,comment_time:this.getnowdate()+" "+this.getnowtime()};console.log(t),(0,a.qV)(t).then((e=>{console.log(e),this.$message({message:"提交成功",type:"success",duration:1e3}),this.dialogFormVisible=!1,this.formvisi.content="",this.querychatfun()})).catch((e=>{console.log(e)}))},getnowdate(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,s=e.getDate()<10?"0"+e.getDate():e.getDate(),l=t+"-"+i+"-"+s;return l},getnowtime(){let e=new Date,t=e.getHours(),i=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),s=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),l=t+":"+i+":"+s;return l},clickPraiseComment(e){console.log("clickPraiseComment",e)},clickDeleteComment(e){console.log("clickDeleteComment",e)},clickDeleteCommentChild(e){console.log("clickDeleteCommentChild",e)},clickRecomment(e){console.log("clickRecomment",e),this.dialogFormVisible=!0,this.placeholdercontent=`回复 ${e.firstnickname}：`,this.recevobj=e},clickRecommentChild(e){console.log("clickRecommentChild",e),this.dialogFormVisible=!0,this.placeholdercontent=`回复 ${e.firstnickname}：`,this.recevobj=e}},watch:{},filters:{updatestatus(e){switch(e){case 0:return"离线";case 1:return"在线"}}}},c=n,h=i(6367),d=(0,h.A)(c,s,l,!1,null,"d6ee2c22",null),m=d.exports}}]);