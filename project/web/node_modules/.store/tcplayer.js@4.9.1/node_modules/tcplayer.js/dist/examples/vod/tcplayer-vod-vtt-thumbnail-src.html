
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no">
  <title>Tcplayer Demo</title>
  <link href="https://web.sdk.qcloud.com/player/tcplayer/release/v4.5.2/tcplayer.min.css" rel="stylesheet">
  <!-- <script src="https://web.sdk.qcloud.com/player/tcplayer/release/v4.5.2/libs/hls.min.0.13.2m.js"></script> -->
  <script src="http://localhost:8081/dist/tcplayer.v4.9.1.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <style>
    html,body{
      margin: 0;
      padding: 0;
    }
    body {
      max-width: 1280px;
      margin: 0 auto;
    }
    .tcplayer {
      margin: 0 auto;
    }

  </style>
</head>
<body>

<div id="container">
  <video id="player-container-id" preload="auto" width="640" height="360" playsinline webkit-playsinline>
  </video>
</div>

<br/>

<div class="input-group mb-3">
  <span class="input-group-text" id="inputGroup-sizing-default">LIVE URL</span>
  <input type="text" id="liveInput" value="http://5000.liveplay.myqcloud.com/testflv/5000_sprite_test_old.m3u8" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
</div>

<div class="input-group mb-3">
  <span class="input-group-text" id="inputGroup-sizing-default">DVR URL</span>
  <input type="text" id="dvrInput" value="http://5000.liveplay.myqcloud.com/testflv/5000_sprite_test_old.m3u8?txTimeshift=on&tsFormat=unix&tsStart=1706253300&tsEnd=1706260500" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
</div>

<br/>

<button type="button" id="init" class="btn btn-primary">init player</button>
<button type="button" id="dvrBtn" class="btn btn-primary">switch DVR</button>
<button type="button" id="liveBtn" class="btn btn-primary">switch LIVE</button>

<br/>

<script>
  var player = null;

  function initVideo () {
    document.getElementById('container').innerHTML = `<video id="player-container-id" preload="auto" width="640" height="360" playsinline webkit-playsinline></video>`;
  }

  function initPlayer () {
    const dvrInputValue = document.getElementById('dvrInput').value;
    const liveInputValue = document.getElementById('liveInput').value;
    console.log('dvrInputValue', dvrInputValue, liveInputValue);

    player && player.dispose();
    initVideo();
    player = TCPlayer("player-container-id", { 
      autoplay: true,
      language: 'en',
      sources: liveInputValue,
      plugins:{
        PDT: true,
        Dvr:{
          mode: 'event',
          dvrButton: true,
          liveURL: liveInputValue,
          shiftURL: dvrInputValue,
        },
        VttThumbnail:{
          enable: true,
        }
      }
    });
  }
  
  initPlayer();

  document.getElementById('init').addEventListener('click', function() {
    initPlayer();
  });

  document.getElementById('liveBtn').addEventListener('click', function() {
    const liveInputValue = document.getElementById('liveInput').value;
    player.src(liveInputValue);
  });

  document.getElementById('dvrBtn').addEventListener('click', function() {
    const dvrInputValue = document.getElementById('dvrInput').value;
    player.src(dvrInputValue);
  });
</script>
</body>
</html>
