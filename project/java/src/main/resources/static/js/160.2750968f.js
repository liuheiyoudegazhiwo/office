"use strict";(self["webpackChunkproject"]=self["webpackChunkproject"]||[]).push([[160],{4160:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pendingflag,expression:"pendingflag"}],staticClass:"user-main"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"user-demoright",attrs:{span:24}},[t("div",{staticClass:"demo-user-search"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{md:6,lg:6}},[t("div",{staticClass:"demo-input-suffix"},[e._v(" 标题： "),t("el-input",{staticClass:"search-user",attrs:{placeholder:"请输入内容"},model:{value:e.search.keyword,callback:function(t){e.$set(e.search,"keyword",t)},expression:"search.keyword"}})],1)]),t("el-col",{attrs:{md:6,lg:6}},[t("div",{staticClass:"demo-input-suffix"},[e._v(" 类型： "),t("el-select",{staticClass:"search-user",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.search.typetext,callback:function(t){e.$set(e.search,"typetext",t)},expression:"search.typetext"}},e._l(e.typearr,(function(e,i){return t("el-option",{key:i,attrs:{label:e.title,value:e.title}})})),1)],1)]),t("el-col",{attrs:{md:6,lg:6}},[t("div",{staticClass:"demo-input-suffix"},[e._v(" 精选： "),t("el-select",{staticClass:"search-user",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.search.goodstatus,callback:function(t){e.$set(e.search,"goodstatus",t)},expression:"search.goodstatus"}},[t("el-option",{attrs:{label:"是",value:"是"}}),t("el-option",{attrs:{label:"否",value:"否"}})],1)],1)]),t("el-col",{attrs:{span:4}},[t("div",{staticClass:"search-butgroup"},[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search",round:""},on:{click:e.searchfun}},[e._v("搜索 ")])],1)])],1)],1),t("div",{staticClass:"demo-user-contentfu"},[t("div",{staticClass:"demo-user-content"},[t("el-row",{staticClass:"demo-user-contentbutleft"},[t("el-col",{attrs:{span:10}},[t("div",{staticClass:"demo-user-contentbutleftsub"})]),t("el-col",{attrs:{span:6}},[e._v(" ")]),t("el-col",{attrs:{span:8}},[t("div",{staticClass:"demo-user-contentbutrightsub"})])],1)],1),t("div",{staticClass:"demo-user-page"},[t("el-table",{ref:"multipleTable",staticClass:"demo-user-tablemore",staticStyle:{width:"100%"},attrs:{"header-cell-style":e.headerstyle,data:e.tableData,height:"500","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e._l(e.griddata,(function(e,i){return t("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",prop:e.prop,label:e.label,width:e.width}})})),t("el-table-column",{attrs:{label:"是否精选",width:"130"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.changestatus(i.$index,i.row)}},model:{value:i.row.goodstatus,callback:function(t){e.$set(i.row,"goodstatus",t)},expression:"scope.row.goodstatus"}})]}}])}),t("el-table-column",{attrs:{prop:"img",label:"图片",width:"160"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{staticClass:"receiveclasspic"},e._l(i.row.trans_Arrpic,(function(i,s){return t("img",{key:s,attrs:{src:i,alt:"",width:"45",height:"45"},on:{click:function(t){return e.showimg(i)}}})})),0)]}}])}),t("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",plain:"",size:"mini"},on:{click:function(t){return e.handleEdit(i.$index,i.row)}}}),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",plain:"",size:"mini"},on:{click:function(t){return e.handleDelete(i.$index,i.row)}}}),t("el-button",{attrs:{type:"warning",icon:"el-icon-view",circle:"",plain:"",size:"mini"},on:{click:function(t){return e.seedata(i.$index,i.row)}}})]}}])})],2)],1)])])],1),t("el-drawer",{attrs:{title:"我是标题",visible:e.drawer,"with-header":!1},on:{"update:visible":function(t){e.drawer=t}}},[t("div",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("commentlist",{attrs:{commentList:e.commentList},on:{clickPraise:e.clickPraiseComment,clickDelete:e.clickDeleteComment,clickDeleteChild:e.clickDeleteCommentChild,clickRecomment:e.clickRecomment,clickRecommentChild:e.clickRecommentChild}})],1)],1)],1)]),t("el-dialog",{staticClass:"diaitemrole",attrs:{title:e.roleinfotitle,visible:e.dialogroleVisible,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.dialogroleVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-row",[t("el-col",{attrs:{span:24}},[t("div",[e._v(e._s(e.fankuiinput))])])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogroleVisible=!1}}},[e._v("取 消")])],1)],1),t("el-dialog",{attrs:{title:"查看图片",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[t("img",{staticClass:"diagimg",attrs:{src:e.imgshow}})])],1)},l=[],n=(i(435),i(2950),i(9511),i(3607),i(1360),i(8151),i(2068),i(2080),i(1071),i(834),i(287)),a=(i(9626),i(6365)),o=i(78),c={name:"extenddevice",components:{commentlist:o.A},created(){this.userinfo=JSON.parse(sessionStorage.getItem("userinfo")),this.init()},mounted(){},data(){return{typearr:[],fankuiinput:"",inpuflag:!0,dialogTableVisible:!1,imgshow:"",dialogFormVisible:!1,id:"",placeholdercontent:"",formvisi:{content:""},commentList:[],userinfo:{},drawer:!1,textarea:"",pendingflag:!1,updatetype:"",single:!0,multiple:!0,roleinfotitle:"",dialogcolnmVisible:!1,dialogroleVisible:!1,dataTree:[],search:{keyword:"",goodstatus:"",typetext:""},griddata:[{prop:"datetime",label:"发布时间",width:"200"},{prop:"descstr",label:"标题",width:"200"},{prop:"detail",label:"内容",width:""},{prop:"username",label:"发布人",width:"200"}],tableData:[],fileListwl:[],multipleSelection:[],currentPage:1,form:{title:"",detail:""},rules:{title:[{required:!0,message:"问题名称不能为空",trigger:"blur"}]},current:1,size:10,total:0,dataitem:[]}},methods:{init(){this.inittype(),this.query()},inittype(){let e={current:1,keyword:"",size:100,status:0};(0,n.Ue)(e).then((e=>{this.typearr=e})).catch((e=>{this.pendingflag=!1}))},seedata(e,t){this.id=t.id,this.querychatfun(),this.drawer=!0},searchfun(){this.query()},showimg(e){this.dialogTableVisible=!0,this.imgshow=e},resetfun(){this.search.keyword=""},handleChange(e){console.log(e)},handleSelectionChange(e){this.multipleSelection=e,this.single=1!=e.length,this.multiple=!e.length},handleSizeChange(e){this.size=e,this.query()},handleCurrentChange(e){this.current=e,this.query()},headerstyle(){return"background-color: #f1f1f1"},colnmsubmit(){this.dialogcolnmVisible=!1},query(){let e={current:1,keyword:this.search.keyword,size:1e3,typetext:this.search.typetext,goodstatus:this.search.goodstatus,userid:0};(0,n.Ts)(e).then((e=>{this.tableData=e.map(((e,t)=>(e.goodstatus="是"==e.goodstatus,e.trans_pic&&(e.trans_Arrpic=e.trans_pic.split(",")),e))),this.pendingflag=!1})).catch((e=>{this.pendingflag=!1}))},getnowdate(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,s=e.getDate()<10?"0"+e.getDate():e.getDate(),l=t+"-"+i+"-"+s;return l},getnowtime(){let e=new Date,t=e.getHours(),i=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),s=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),l=t+":"+i+":"+s;return l},userinfosubmit(){let e;this.userinfo;this.pendingflag=!0,"top"==this.updatetype&&(e=this.multipleSelection[0].id),"line"==this.updatetype&&(e=this.form.id);let t={fankui:this.fankuiinput,id:e};(0,n.O)(t).then((e=>{this.fankuiinput="",this.query(),this.$message.success("操作成功"),this.dialogitemVisible=!1})).catch((e=>{this.dialogitemVisible=!1,this.pendingflag=!1})),this.dialogroleVisible=!1},transpicurl(e){let t=[];return e.forEach((e=>{t.push(e.url)})),t.join("^^^")},updatedata(){this.dialogroleVisible=!0,this.roleinfotitle="详情",this.updatetype="top",this.form=this.multipleSelection[0]},handleRemovewl(e,t){this.fileListwl=t},handlePictureCardPreviewwl(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleSuccesswl(e,t,i){console.log(e,t,i);let s=e,l=t.name,n={url:s,name:l};this.fileListwl.push(n)},handleEdit(e,t){this.updatetype="line",this.roleinfotitle="详情",this.dialogroleVisible=!0;let i=(0,a.A4)(t);this.form=i,this.fankuiinput=i.detail},changestatus(e,t){let i={id:t.id,goodstatus:t.goodstatus?"是":"否"};(0,n.L)(i).then((e=>{this.query(),this.$message.success("操作成功")})).catch((e=>{}))},chatDelete(e){let t=this;this.$confirm("此操作将永久删除该评论以及子评论, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let i={id:e};(0,n.hn)(i).then((e=>{t.querychatfun(),t.$message.success("操作成功")})).catch((e=>{t.$message.error("操作失败")}))})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},handleDelete(e,t){let i=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{i.pendingflag=!0;let e={id:t.id};i.pendingflag=!0,(0,n.EZ)(e).then((e=>{i.query(),i.$message.success("操作成功")})).catch((e=>{i.$message.error("操作失败"),i.pendingflag=!1}))})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},addtop(){this.dialogroleVisible=!0,this.roleinfotitle="新增问题",this.reset()},reset(){this.form.title="",this.form.detail="",this.fileListwl=[]},excelinit(){let e=this,t="";document.querySelector("#file").addEventListener("change",(function(){var i=document.querySelector("#file").files[0],s=i.name.split(".");if("xlsx"!==s[s.length-1]&&"xls"!==s[s.length-1])return alert("只能选择excel文件导入"),!1;const l=new FileReader;l.readAsBinaryString(i),l.onload=i=>{const s=i.target.result,l=window.XLS.read(s,{type:"binary"}),a=[];for(let e=0;e<l.SheetNames.length;e++){const t=window.XLS.utils.sheet_to_json(l.Sheets[l.SheetNames[e]]);a.push(...t)}console.log("result",a),t=a;let o=a.map(((e,t)=>e));e.$confirm("此操作将将追加数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{e.pendingflag=!0,(0,n.saveactivityexcel)(o).then((t=>{location.reload(),console.log(t),e.query(),e.pendingflag=!1})).catch((t=>{e.pendingflag=!1}))})).catch((()=>{e.$message({type:"info",message:"已取消"})}))}}))},saveAs(e,t){var i=document.createElement("a");i.download=t||"下载",i.href=URL.createObjectURL(e),i.click(),setTimeout((function(){URL.revokeObjectURL(e)}),100)},downloadExl(e,t){console.log(e);let i=this;const s={SheetNames:["Sheet1"],Sheets:{},Props:{}};s.Sheets["Sheet1"]=XLSX.utils.json_to_sheet(e);let l={bookType:"xlsx",bookSST:!1,type:"binary"};console.log(l),this.saveAs(new Blob([i.s2ab(XLSX.write(s,l))],{type:"application/octet-stream"}),"这里是下载的文件名."+("biff2"==l.bookType?"xls":l.bookType))},s2ab(e){if("undefined"!==typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),s=0;s!=e.length;++s)i[s]=255&e.charCodeAt(s);return t}for(t=new Array(e.length),s=0;s!=e.length;++s)t[s]=255&e.charCodeAt(s);return t},querychatfun(){let e={annid:this.id};(0,n.y1)(e).then((e=>{console.log(e);let t=[];e.forEach((e=>{0==e.PARENTID&&t.push(e)})),t=t.map(((e,t)=>(e.CHILD_ANWSER_LIST=[],e)));for(let i=0;i<t.length;i++)for(let s=0;s<e.length;s++)t[i].id==e[s].PARENTID&&t[i].CHILD_ANWSER_LIST.push(e[s]);this.commentList=t})).catch((e=>{console.log(e)}))},submitfun(){if(console.log(this.userinfo),!this.userinfo)return this.$message({message:"请先登录",type:"error",duration:1e3}),!1;let e={annid:this.id,commenttime:this.getnowdate()+" "+this.getnowtime(),firstnickname:this.userinfo.userName,ispraise:null,comment:this.textarea,praisenum:0,candelete:0,headimg:"https://mp-7d66f2cd-2fba-462e-ad49-e2c42e1693fd.cdn.bspapp.com/img/logo01.png",parentid:0,secondnickname:null};insertchatart(e).then((e=>{console.log(e),this.$message({message:"提交成功",type:"success",duration:3e3}),this.textarea="",this.querychatfun()})).catch((e=>{console.log(e)}))},submitsubfun(){if(!this.userinfo)return this.$message({message:"请先登录",type:"error",duration:3e3}),!1;let e;e=0==this.recevobj.PARENTID?this.recevobj.id:this.recevobj.PARENTID;let t={annid:this.id,commenttime:this.getnowdate()+" "+this.getnowtime(),firstnickname:this.userinfo.userName,ispraise:null,comment:this.formvisi.content,praisenum:0,candelete:0,headimg:"https://mp-7d66f2cd-2fba-462e-ad49-e2c42e1693fd.cdn.bspapp.com/img/logo01.png",parentid:e,secondnickname:this.recevobj.FIRSTNICKNAME};console.log(t),insertchatart(t).then((e=>{console.log(e),this.$message({message:"提交成功",type:"success",duration:1e3}),this.dialogFormVisible=!1,this.formvisi.content="",this.querychatfun()})).catch((e=>{console.log(e)}))},clickPraiseComment(e){console.log("clickPraiseComment",e)},clickDeleteComment(e){console.log("clickDeleteComment",e),this.chatDelete(e.id)},clickDeleteCommentChild(e){console.log("clickDeleteCommentChild",e),this.chatDelete(e.id)},clickRecomment(e){console.log("clickRecomment",e),this.dialogFormVisible=!0,this.placeholdercontent=`回复 ${e.FIRSTNICKNAME}：`,this.recevobj=e},clickRecommentChild(e){console.log("clickRecommentChild",e),this.dialogFormVisible=!0,this.placeholdercontent=`回复 ${e.FIRSTNICKNAME}：`,this.recevobj=e}},watch:{},filters:{updatestatus(e){switch(e){case 0:return"离线";case 1:return"在线"}}}},r=c,h=i(6367),d=(0,h.A)(r,s,l,!1,null,"e31d21ac",null),m=d.exports},78:function(e,t,i){i.d(t,{A:function(){return r}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"view-content-comment",staticStyle:{"margin-bottom":"100rpx"}},[t("span",{staticClass:"title"},[e._v(e._s(e.title))]),0==e.commentList.length?t("div",{staticClass:"view-conmment-note"},[t("span",{staticClass:"text-conmment-note"},[e._v("暂无评论")])]):e._e(),e._l(e.commentList,(function(i,s){return e.commentList.length>0?t("div",{key:s,staticClass:"view-comment-list"},[t("img",{staticClass:"view-comment-list-item-photo",attrs:{src:i.HEADIMGURL,width:"50",height:"50"}}),t("div",{staticClass:"view-comment-list-item"},[t("div",{staticClass:"comment-title"},[t("span",{staticClass:"comment-name"},[e._v(e._s(i.FIRSTNICKNAME))])]),t("span",{staticClass:"comment-content"},[e._v(e._s(i.COMMENT))]),t("div",{staticClass:"comment-sub"},[t("span",{staticClass:"comment-sub-time"},[e._v(e._s(i.COMMENT_TIME))]),t("div",{staticClass:"comment-sub-recomment",staticStyle:{color:"#999999"},on:{click:function(t){return e.clickDelete(i)}}},[e._v("删除")]),t("div",{staticClass:"comment-sub-recomment",on:{click:function(t){return e.clickRecomment(i)}}},[e._v("回复")])]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.CHILD_ANWSER_LIST.length>0,expression:"item.CHILD_ANWSER_LIST.length > 0"}],staticClass:"comment-child"},e._l(i.CHILD_ANWSER_LIST,(function(i,s){return t("div",{key:s,staticClass:"comment-child-item"},[t("span",{staticClass:"comment-child-item-name",on:{click:function(t){return e.clickRecommentChild(i)}}},[e._v(e._s(i.FIRSTNICKNAME+"："))]),i.SECONDNICKNAME?t("span",{staticClass:"comment-child-item-content"},[e._v("回复")]):e._e(),t("span",{staticClass:"comment-child-item-content"},[e._v(e._s(i.SECONDNICKNAME?i.SECONDNICKNAME:""))]),i.SECONDNICKNAME?t("span",{staticClass:"comment-child-item-content"},[e._v("：")]):e._e(),t("span",{staticClass:"comment-child-item-content"},[e._v(e._s(i.COMMENT))]),t("span",{staticClass:"comment-child-item-delete",on:{click:function(t){return e.clickDeleteChild(i)}}},[e._v("删除")])])})),0)])]):e._e()}))],2)},l=[],n={name:"MulCommentList",props:{commentList:{type:Array},title:{type:String,default:"网友评论"}},data(){return{}},methods:{clickPraise(e){this.$emit("clickPraise",e)},clickRecomment(e){this.$emit("clickRecomment",e)},clickDelete(e){this.$emit("clickDelete",e)},clickDeleteChild(e){this.$emit("clickDeleteChild",e)},clickRecommentChild(e){this.$emit("clickRecommentChild",e)}}},a=n,o=i(6367),c=(0,o.A)(a,s,l,!1,null,null,null),r=c.exports}}]);