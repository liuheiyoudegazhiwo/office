"use strict";
Object.defineProperties(exports, { __esModule: { value: true }, [Symbol.toStringTag]: { value: "Module" } });
const Vue = require("vue");
require("../../../../adapter-vue.js");
const universalApi = require("@tencentcloud/universal-api");
const Icon = require("../../../common/Icon.vue.js");
const index = require("../../../common/BottomPopup/index.vue.js");
const env = require("../../../../utils/env.js");
const config = require("../../config.js");
const _hoisted_1 = {
  key: 0,
  class: /* @__PURE__ */ Vue.normalizeClass(["toolbar-item-container-uni-title"])
};
const _sfc_main = /* @__PURE__ */ Vue.defineComponent({
  __name: "index",
  props: {
    iconFile: {
      type: String,
      required: true
    },
    title: {
      type: String,
      default: ""
    },
    needDialog: {
      type: Boolean,
      default: true
    },
    iconWidth: {
      type: String,
      default: "20px"
    },
    iconHeight: {
      type: String,
      default: "20px"
    },
    // Whether to display the bottom popup dialog on mobile devices
    // Invalid on PC
    needBottomPopup: {
      type: Boolean,
      default: false
    }
  },
  emits: ["onIconClick", "onDialogClose", "onDialogShow"],
  setup(__props, { expose: __expose, emit: __emit }) {
    const props = __props;
    const emits = __emit;
    const isDark = Vue.ref(config.default.getTheme() === "dark");
    const showDialog = Vue.ref(false);
    const toolbarItemRef = Vue.ref();
    const dialogRef = Vue.ref();
    const toggleToolbarItem = () => {
      emits("onIconClick", dialogRef);
      if (env.isPC) {
        universalApi.outsideClick.listen({
          domRefs: toolbarItemRef.value,
          handler: closeToolbarItem
        });
      }
      if (!props.needDialog) {
        return;
      }
      toggleDialogDisplay(!showDialog.value);
    };
    const closeToolbarItem = () => {
      showDialog.value = false;
      emits("onDialogClose", dialogRef);
    };
    const toggleDialogDisplay = (showStatus) => {
      if (showDialog.value === showStatus) {
        return;
      }
      showDialog.value = showStatus;
      switch (showStatus) {
        case true:
          emits("onDialogShow", dialogRef);
          break;
        case false:
          emits("onDialogClose", dialogRef);
      }
    };
    const onPopupClose = () => {
      showDialog.value = false;
    };
    __expose({
      toggleDialogDisplay
    });
    return (_ctx, _cache) => {
      return Vue.openBlock(), Vue.createElementBlock("div", {
        ref_key: "toolbarItemRef",
        ref: toolbarItemRef,
        class: Vue.normalizeClass([
          "toolbar-item-container",
          !Vue.unref(env.isPC) && "toolbar-item-container-h5",
          Vue.unref(env.isUniFrameWork) && "toolbar-item-container-uni"
        ])
      }, [
        Vue.createElementVNode("div", {
          class: Vue.normalizeClass([
            "toolbar-item-container-icon",
            Vue.unref(env.isUniFrameWork) && "toolbar-item-container-uni-icon"
          ]),
          onClick: toggleToolbarItem
        }, [
          Vue.createVNode(Icon.default, {
            file: props.iconFile,
            class: "icon",
            width: props.iconWidth,
            height: props.iconHeight
          }, null, 8, ["file", "width", "height"])
        ], 2),
        Vue.unref(env.isUniFrameWork) ? (Vue.openBlock(), Vue.createElementBlock("div", _hoisted_1, Vue.toDisplayString(props.title), 1)) : Vue.createCommentVNode("", true),
        Vue.withDirectives(Vue.createElementVNode("div", {
          ref_key: "dialogRef",
          ref: dialogRef,
          class: Vue.normalizeClass([
            "toolbar-item-container-dialog",
            Vue.unref(isDark) && "toolbar-item-container-dialog-dark",
            !Vue.unref(env.isPC) && "toolbar-item-container-h5-dialog",
            Vue.unref(env.isUniFrameWork) && "toolbar-item-container-uni-dialog"
          ])
        }, [
          props.needBottomPopup && !Vue.unref(env.isPC) ? (Vue.openBlock(), Vue.createBlock(index.default, {
            key: 0,
            class: "toolbar-bottom-popup",
            show: Vue.unref(showDialog),
            onTouchmove: _cache[0] || (_cache[0] = Vue.withModifiers(() => {
            }, ["stop", "prevent"])),
            onOnClose: onPopupClose
          }, {
            default: Vue.withCtx(() => [
              Vue.renderSlot(_ctx.$slots, "default", {}, void 0, true)
            ]),
            _: 3
          }, 8, ["show"])) : Vue.renderSlot(_ctx.$slots, "default", { key: 1 }, void 0, true)
        ], 2), [
          [Vue.vShow, Vue.unref(showDialog)]
        ])
      ], 2);
    };
  }
});
exports.default = _sfc_main;
